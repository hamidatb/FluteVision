<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Game Mode - FluteVision</title>
    <link rel="stylesheet" href="src/css/shared.css">
    <link rel="stylesheet" href="src/css/game.css">
</head>
<body>
    <header>
        <h1>ðŸŽµ FluteVision</h1>
        <p class="subtitle">Game Mode</p>
        <button id="navToggle" class="nav-toggle">Menu</button>
        <div class="nav-links">
            <a href="index.html">Home</a>
            <a href="practice.html">Practice</a>
            <a href="game.html" class="active">Game</a>
        </div>
    </header>
    
    <!-- Floating camera toggle button -->
    <button id="cameraToggleBtn" class="camera-toggle-btn" title="Toggle Camera">
        <span class="camera-status-icon">ðŸ“¹</span>
    </button>
    
    <div id="game-container">
        <div class="game-wrapper">
            <!-- Camera feed -->
            <div class="camera-panel">
                <video id="video" autoplay playsinline></video>
                <div class="prediction-display">
                    <div class="current-gesture" id="currentGesture">-</div>
                    <div class="confidence-bar">
                        <div class="confidence-fill" id="confidenceFill"></div>
                    </div>
                </div>
            </div>
            
            <!-- Game canvas -->
            <div class="game-panel">
                <canvas id="gameCanvas"></canvas>
                
                <!-- Game UI overlay -->
                <div class="game-ui">
                    <div class="target-gesture">
                        <span class="label">Play:</span>
                        <span class="gesture" id="targetGesture">-</span>
                    </div>
                    <div class="score-display">
                        <span class="label">Score:</span>
                        <span class="score" id="score">0</span>
                        <span class="combo" id="combo"></span>
                    </div>
                    <div class="high-score">
                        <span class="label">Best:</span>
                        <span class="score" id="highScore">0</span>
                    </div>
                </div>
                
                <!-- Game over screen -->
                <div id="gameOverScreen" class="game-over hidden">
                    <h2>Game Over!</h2>
                    <p class="final-score">Score: <span id="finalScore">0</span></p>
                    <p class="final-combo">Max Combo: <span id="finalCombo">0</span></p>
                    <button id="restartBtn" class="game-btn">Play Again</button>
                </div>
                
                <!-- Start screen -->
                <div id="startScreen" class="start-screen">
                    <h2>Ready to Play?</h2>
                    <p>watch the target gesture and play it to make your character jump!</p>
                    <p style="font-size: 0.9rem; color: #666; margin-top: 10px;">
                        <strong>Testing:</strong> Press <kbd style="background: #f3f4f6; padding: 2px 6px; border-radius: 3px; border: 1px solid #ccc;">Space</kbd> to jump
                    </p>
                    <div id="status" class="status">Initializing...</div>
                    <button id="startBtn" class="game-btn" disabled>Start Game</button>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Reuse existing camera/API infrastructure -->
    <script src="src/js/api.js"></script>
    <script src="src/js/camera.js"></script>
    <script src="src/js/navigation.js"></script>
    
    <!-- Load in dependency order (bc modules depend on each other) -->
    
    <!-- Config layer -->
    <script src="src/js/game/config/GameConstants.js"></script>
    <script src="src/js/game/config/GameSettings.js"></script>
    
    <!-- Assets & Music -->
    <script src="src/js/game/assets/AssetManager.js"></script>
    <script src="src/js/game/music/MusicalTest.js"></script>
    <script src="src/js/game/music/TestLibrary.js"></script>
    
    <!-- Entities -->
    <script src="src/js/game/entities/Player.js"></script>
    <script src="src/js/game/entities/Obstacle.js"></script>
    
    <!-- Systems -->
    <script src="src/js/game/systems/CollisionSystem.js"></script>
    <script src="src/js/game/systems/RenderSystem.js"></script>
    
    <!-- Managers -->
    <script src="src/js/game/managers/ScoreManager.js"></script>
    <script src="src/js/game/managers/InputManager.js"></script>
    
    <!-- Core Engine -->
    <script src="src/js/game/core/GameEngine.js"></script>
    
    <!-- UI Layer -->
    <script src="src/js/game/ui/SettingsUI.js"></script>
    <script src="src/js/game/ui/GameController.js"></script>
    
    <script>
        // initialize when page loads
        window.addEventListener('DOMContentLoaded', () => {
            const controller = new GameController();
            controller.initialize();
        });
    </script>
</body>
</html>
